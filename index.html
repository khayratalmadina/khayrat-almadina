<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>khayrat almadina - واجهة رأسية</title>
  <!-- Bootstrap 5 مع RTL -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <!-- خط Cairo -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    /* الوضع الليلي */
    body.dark-mode .product-card {
      background: #34495e;
      color: #ecf0f1;
    }
    body.dark-mode .product-card .product-title,
    body.dark-mode .product-card .product-details,
    body.dark-mode .product-card .product-price {
      color: #ecf0f1;
    }
    /* المتغيرات الأساسية */
    :root {
      --primary-color: #2980b9;
      --secondary-color: #27ae60;
      --accent-color: #f39c12;
      --background: #f0f8ff;
      --sidebar-bg: #fff;
      --modal-bg: rgba(0,0,0,0.7);
    }
    body {
      font-family: 'Cairo', sans-serif;
      background: var(--background);
      margin: 0;
      padding: 0;
      transition: background 0.3s ease;
    }
    body.dark-mode {
      background: #2c3e50;
      color: #ecf0f1;
    }
    body.dark-mode .sidebar {
      background: #34495e;
    }
    body.dark-mode .sidebar .menu-item svg,
    body.dark-mode .sidebar .menu-item span.label {
      fill: #ecf0f1;
      color: #ecf0f1;
    }
    body.dark-mode .modal-content {
      background: #2c3e50;
      color: #ecf0f1;
    }
    body.dark-mode .pharmacy-form input,
    body.dark-mode .pharmacy-form textarea {
      background: #34495e;
      color: #ecf0f1;
      border: 1px solid #555;
    }
    /* الشريط الجانبي */
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 70px;
      height: 100%;
      background: var(--sidebar-bg);
      box-shadow: 2px 0 8px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1rem 0;
      transition: width 0.3s ease;
      z-index: 1200;
    }
    .sidebar.expanded {
      width: 200px;
    }
    .sidebar .menu-item {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 1rem 0;
      cursor: pointer;
      position: relative;
      transition: background 0.3s;
    }
    .sidebar .menu-item:hover {
      background: rgba(0,0,0,0.05);
    }
    .sidebar.expanded .menu-item {
      justify-content: flex-start;
      padding-left: 1rem;
    }
    .sidebar .menu-item span.label {
      display: none;
      margin-left: 0.5rem;
      font-size: 1rem;
      color: var(--primary-color);
    }
    .sidebar.expanded .menu-item span.label {
      display: inline;
    }
    .sidebar .menu-item svg {
      width: 24px;
      height: 24px;
      fill: var(--primary-color);
    }
    /* منطقة المحتوى */
    .main-content {
      margin-left: 80px;
      padding: 1rem;
      position: relative;
    }
    header {
      padding: 1rem;
      border-bottom: 1px solid #ccc;
    }
    header h1 {
      font-size: 2rem;
      margin: 0;
    }
    header p {
      font-size: 1rem;
      color: var(--accent-color);
      margin: 0.5rem 0 0;
    }
    /* عرض عدد الأعضاء مع أيقونة */
    .member-count {
      background: rgba(0,0,0,0.05);
      padding: 0.2rem 0.5rem;
      border-radius: 5px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }
    body.dark-mode .member-count {
      background: rgba(255,255,255,0.1);
    }
    /* شريط البحث الذي يتمدد عند النقر */
    #search-bar-container {
      position: fixed;
      top: 70px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      overflow: hidden;
      transition: width 0.5s ease;
      z-index: 1500;
    }
    #search-bar-container.active {
      width: 80%;
      max-width: 600px;
    }
    #search-bar {
      width: 100%;
      padding: 0.5rem 1rem;
      font-size: 1.2rem;
      border: 2px solid var(--primary-color);
      border-radius: 25px;
      outline: none;
    }
    /* شبكة المنتجات */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
    }
    .product-card {
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: transform 0.3s;
      position: relative;
      display: flex;
      flex-direction: column;
    }
    .product-card:hover {
      transform: translateY(-3px);
    }
    .product-card img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      cursor: pointer;
    }
    .product-card .card-body {
      padding: 0.5rem 0.8rem;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .product-card .product-title {
      font-size: 1rem;
      font-weight: bold;
      margin-bottom: 0.3rem;
      position: relative;
    }
    .product-card .product-details {
      font-size: 0.8rem;
      color: #7f8c8d;
      margin-bottom: 0.5rem;
    }
    .product-card .product-price {
      font-size: 0.9rem;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }
    /* شارة أفضل المبيعات */
    .best-seller-badge {
      position: absolute;
      top: 0;
      left: 0;
      background: var(--accent-color);
      color: #fff;
      padding: 5px 10px;
      font-size: 0.8rem;
      font-weight: bold;
      border-bottom-right-radius: 10px;
      z-index: 5;
    }
    /* يمكنك أيضاً تمييز البطاقة بإضافة حد */
    .best-seller {
      border: 2px solid var(--accent-color);
    }
    /* أزرار تحديد الكمية */
    .quantity-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      margin-top: auto;
      position: relative;
    }
    .quantity-controls button {
      border: none;
      background: var(--secondary-color);
      color: #fff;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.3s;
      position: relative;
      overflow: visible;
    }
    .quantity-controls button:hover {
      background: #1e8449;
    }
    .quantity-controls span {
      font-size: 1rem;
      width: 20px;
      text-align: center;
    }
    /* مؤشرات الحركة */
    .indicator {
      pointer-events: none;
      font-size: 2rem;
      font-weight: bold;
      opacity: 1;
      position: absolute;
      z-index: 10;
    }
    .plus-indicator {
      color: green;
      animation: plusAnim 0.5s ease forwards;
    }
    .minus-indicator {
      color: red;
      animation: minusAnim 0.5s ease forwards;
    }
    @keyframes plusAnim {
      0% { opacity: 1; transform: translateY(0) scale(1); }
      100% { opacity: 0; transform: translateY(-30px) scale(1.5); }
    }
    @keyframes minusAnim {
      0% { opacity: 1; transform: translateY(0) scale(1); }
      100% { opacity: 0; transform: translateY(30px) scale(1.5); }
    }
    /* تأثير الاهتزاز */
    @keyframes shake {
      0% { transform: translate(0, 0); }
      25% { transform: translate(-2px, 0); }
      50% { transform: translate(2px, 0); }
      75% { transform: translate(-2px, 0); }
      100% { transform: translate(0, 0); }
    }
    .shake {
      animation: shake 0.3s ease;
    }
    /* زر حفظ المنتج */
    .save-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      cursor: pointer;
      transition: transform 0.3s;
    }
    .save-btn svg {
      width: 24px;
      height: 24px;
      fill: #ccc;
      transition: fill 0.3s;
    }
    .save-btn.active svg {
      fill: red;
    }
    @keyframes heartbeat {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    .animate-heart {
      animation: heartbeat 0.5s ease;
    }
    /* أنميشن لزر البحث */
    @keyframes searchBounce {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    .animate-search {
      animation: searchBounce 0.5s ease;
    }
    /* زر السلة العائم - تغيير الأيقونة */
    .fab-cart {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: var(--primary-color);
      border: none;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 1.5rem;
      z-index: 1300;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      cursor: pointer;
      transition: transform 0.3s;
    }
    .fab-cart:hover {
      transform: scale(1.1);
    }
    /* أنماط النوافذ المنبثقة */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--modal-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease;
      z-index: 1400;
    }
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    .modal-content {
      background: #fff;
      border-radius: 10px;
      padding: 1.5rem;
      width: 90%;
      max-width: 500px;
      position: relative;
      animation: slideIn 0.3s ease;
      font-size: 1rem;
      color: #333;
    }
    body.dark-mode .modal-content {
      background: #2c3e50;
      color: #ecf0f1;
    }
    @keyframes slideIn {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .modal-close {
      position: absolute;
      top: 10px;
      right: 10px;
      border: none;
      background: none;
      font-size: 1.2rem;
      cursor: pointer;
    }
    /* ملخص سلة الشراء */
    .cart-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      border-bottom: 1px solid #ddd;
      padding-bottom: 0.3rem;
      cursor: pointer;
    }
    .cart-total {
      text-align: right;
      font-weight: bold;
      margin-top: 1rem;
    }
    .btn-purchase {
      width: 100%;
      margin-top: 1rem;
    }
    /* نموذج معلومات الصيدلية */
    .pharmacy-form input,
    .pharmacy-form textarea {
      margin-bottom: 0.8rem;
      font-size: 1rem;
      padding: 0.5rem;
    }
    /* تحسين النصوص داخل النوافذ */
    .modal-header h4,
    .modal-header h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }
    .modal-body,
    #favorites-content,
    #most-sold-content {
      font-size: 1rem;
    }
    /* أنميشن لتبديل أيقونة الوضع */
    .toggle-animation {
      animation: iconRotate 0.5s ease;
    }
    @keyframes iconRotate {
      0% { transform: rotate(0deg) scale(1); }
      50% { transform: rotate(180deg) scale(1.2); }
      100% { transform: rotate(360deg) scale(1); }
    }
    /* أنميشن زر الرئيسية */
    .animate-home {
      animation: homeBounce 0.5s ease;
    }
    @keyframes homeBounce {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    /* نافذة تكبير صورة المنتج */
    .image-modal-content {
      width: 35vw;
      height: 35vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff;
      border-radius: 10px;
      position: relative;
    }
    .image-modal-content img {
      max-width: 100%;
      max-height: 100%;
    }
    /* تمييز بطاقة المنتج عند التوجيه */
    .highlight {
      animation: highlightAnim 1s ease;
    }
    @keyframes highlightAnim {
      0% { box-shadow: 0 0 10px yellow; }
      100% { box-shadow: none; }
    }
  </style>
</head>
<body>
  <!-- الشريط الجانبي مع أزرار البحث والأكثر مبيعا والمحفوظات -->
  <div class="sidebar" id="sidebar">
    <!-- زر الهامبرجر -->
    <div class="menu-item" id="toggle-sidebar" title="القائمة">
      <svg viewBox="0 0 24 24">
        <path d="M3 6h18M3 12h18M3 18h18" stroke="var(--primary-color)" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span class="label">القائمة</span>
    </div>
    <!-- زر الرئيسية -->
    <div class="menu-item" id="menu-home" title="الرئيسية">
      <svg viewBox="0 0 24 24">
        <path d="M12 3l9 8-3 3-6 6-6-6-3-3 9-8z"/>
      </svg>
      <span class="label">الرئيسية</span>
    </div>
    <!-- زر البحث -->
    <div class="menu-item" id="menu-search" title="بحث">
      <svg viewBox="0 0 24 24">
        <path d="M21 21l-4.35-4.35M10 18a8 8 0 100-16 8 8 0 000 16z" stroke="var(--primary-color)" stroke-width="2" stroke-linecap="round" fill="none"/>
      </svg>
      <span class="label">بحث</span>
    </div>
    <!-- زر الأكثر مبيعا -->
    <div class="menu-item" id="menu-most-sold" title="الأكثر مبيعا">
      <svg viewBox="0 0 24 24">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" stroke="var(--primary-color)" stroke-width="2" fill="none"/>
      </svg>
      <span class="label">الأكثر مبيعا</span>
    </div>
    <!-- زر المحفوظات -->
    <div class="menu-item" id="menu-favorites" title="المحفوظات">
      <svg viewBox="0 0 24 24" data-icon="heart">
        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5
          2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3
          16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
      </svg>
      <span class="label">المحفوظات</span>
    </div>
    <!-- زر تبديل الوضع -->
    <div class="menu-item" id="menu-darkmode" title="تبديل الوضع">
      <svg id="darkmode-icon" viewBox="0 0 24 24">
        <path d="M21 12.79A9 9 0 0111.21 3 7 7 0 1012 21a9 9 0 009-8.21z"/>
      </svg>
      <span class="label">الوضع</span>
    </div>
  </div>
  
  <!-- شريط البحث الذي يتمدد عند النقر -->
  <div id="search-bar-container">
    <input type="text" id="search-bar" placeholder="ابحث عن منتج...">
  </div>
  
  <!-- منطقة المحتوى -->
  <div class="main-content">
    <header>
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <h1>khayrat almadina</h1>
        <!-- عرض عدد الأعضاء مع أيقونة -->
        <div class="member-count">
          <svg width="24" height="24" viewBox="0 0 24 24">
            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
          </svg>
          <span id="member-count"></span>
        </div>
      </div>
      <p>تسوق طبي مبتكر وعصري</p>
    </header>
    <!-- شبكة المنتجات -->
    <div class="product-grid" id="product-grid">
      <!-- تُحقن بطاقات المنتجات عبر JavaScript -->
    </div>
  </div>
  
  <!-- زر السلة العائم مع رمز جديد (مثال على أيقونة حقيبة التسوق) -->
  <button class="fab-cart" id="fab-cart">
    <svg viewBox="0 0 24 24" width="28" height="28">
      <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 
      0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2M7.82 
      14h8.36c.75 0 1.41-.41 1.75-1.03l3.24-5.88c.2-.36.29-.78.22-1.19-.08-.41-.33-.76-.7-.98A1.997 
      1.997 0 0019.5 5H5.21l-.94-2H1v2h2l3.6 7.59-1.35 2.44C5.16 
      16.37 5 16.68 5 17c0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 
      14z" fill="#fff"/>
    </svg>
  </button>
  
  <!-- نوافذ منبثقة: سلة الشراء، المحفوظات، الأكثر مبيعا، وتكبير صورة المنتج -->
  <div class="modal-overlay" id="cart-modal">
    <div class="modal-content" id="cart-modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <div id="modal-dynamic-content">
        <!-- محتوى النافذة الديناميكي -->
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="favorites-modal">
    <div class="modal-content" id="favorites-modal-content">
      <button class="modal-close" id="favorites-modal-close">&times;</button>
      <div id="favorites-content">
        <!-- منتجات المحفوظات -->
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="most-sold-modal">
    <div class="modal-content" id="most-sold-modal-content">
      <button class="modal-close" id="most-sold-modal-close">&times;</button>
      <div id="most-sold-content">
        <!-- منتجات الأكثر مبيعا -->
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="image-modal">
    <div class="modal-content image-modal-content">
      <button class="modal-close" id="image-modal-close">&times;</button>
      <img id="modal-image" src="" alt="صورة المنتج">
    </div>
  </div>
  
  <!-- سكريبت التحكم -->
  <script>
    /* تعريف الرموز (validCodes) في النطاق العام حتى نتمكن من استخدامها لحساب عدد الأعضاء */
    const validCodes = ["272311", "07730799909", "07736374464", "07802431779", "07822632020", "07854009540", "07804984615", "07852723311", "07737530689", "B1C2D3"];
  
    // التحقق من الرمز قبل عرض الموقع
    (function(){
      let code = prompt("يرجى إدخال الرمز للوصول إلى الموقع:");
      while (!validCodes.includes(code)) {
        alert("الرمز غير صحيح. الرجاء المحاولة مرة أخرى.");
        code = prompt("يرجى إدخال الرمز للوصول إلى الموقع:");
      }
    })();
  
    /* بيانات المنتجات والسلة والمحفظات */
    const products = [
      { id: 1, name: "نورمل سلاين 100ml", details: " كارتون 100 قطعة خصم 10%", price: 62000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480124735_122143364288425327_2576983287849537910_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=106&ccb=1-7&_nc_sid=833d8c&_nc_ohc=81SCASu4cmMQ7kNvgHRGPfb&_nc_oc=AdiTqCT1UKLNF_7xsZ6Rx5tr0VWsbQc51mHKuqnb5N1YSbap1nqx__sloAD9HXI1MQE&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AadfNKf13j2S9bETlaUvhEr&oh=00_AYCDyEh1qhxi9hbThfcbq4kXbXupPGD-dcU_h19dyfoTNQ&oe=67B6751C" },
      { id: 2, name: "paracetamol 100ml", details: "الكارتون 35 قطعة خصم 10%", price: 64750, quantity: 0, image: "https://scontent.fnjf1-4.fna.fbcdn.net/v/t39.30808-6/480024026_122143358882425327_593697694774746907_n.jpg?stp=dst-jpg_s960x960_tt6&_nc_cat=107&ccb=1-7&_nc_sid=833d8c&_nc_ohc=2PVqWlNMVqcQ7kNvgGhgFt9&_nc_oc=AdjMdY0Gg8FAj7Z48y_jqZ_ff3nvogkwJtEOtg9HFITFZxNJv4zZlUf2OGsZZstvZjQ&_nc_zt=23&_nc_ht=scontent.fnjf1-4.fna&_nc_gid=AtDqeQgtBOUgtHj308FcaoD&oh=00_AYBGSvW8zFbOwz00Pr0NY1GO12ncF89ogpRYdPMwWQxrzA&oe=67B67FE8" },
      { id: 3, name: "نورمل سلاين 500ml",details: "مفحوص بغداد الكارتون 30 قطعة", price: 43500, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480002321_122143350740425327_7940429594012547575_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=106&ccb=1-7&_nc_sid=833d8c&_nc_ohc=B_RF1CO2PIUQ7kNvgHGni1u&_nc_oc=AdiE5ovpxEkbzMgsprah5FpbFjc5Ad3N6gSm4-KxjGrbj2--5zmGn8F-tLIMlBXe8gs&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=ArR4jDbTSv5UoW6dRAk3grk&oh=00_AYCJCI7IlEOfBJLEmj7YLu8GhzsxETcV2_HWRyu84zW4Lg&oe=67B6A6AE" },
      { id: 5, name: "NORMAL SALINE 100ml هندي", details: "الكارتون 100 قطعة الخصم 10%" , price: 57000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480555410_122143351502425327_59173961902824543_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=105&ccb=1-7&_nc_sid=833d8c&_nc_ohc=fyU_huqaAJQQ7kNvgGL8I-2&_nc_oc=AdjIGSDwlJMHX-FtDeH-vE5Ldm3C7mQP7s9GXDaqgOAhakw5O-2ROrh_LTtfCsf5oas&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AuLhxuxUgCICXGF7snLtcwh&oh=00_AYBHlqqXU7yV5aFosO4mZUz7OqTT2qGO_PIao6r4bWCy5w&oe=67B656C2" },
      { id: 6, name: "Ringer 500ml", details: "الكارتون 30 قطعة ", price: 43500, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480047181_122143213496425327_3433786074011406291_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=103&ccb=1-7&_nc_sid=833d8c&_nc_ohc=Fqq5Wsb6LVEQ7kNvgGqq07b&_nc_oc=Adi4LFubfA2NHqnl-M9WraSNLCcYbqCQYYZYKwEaLYgiWplt0QbfxnODL0ANWuDhSf8&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=A49e-uETQ5U9r-GFgvJs8jX&oh=00_AYDlo8ZDm7-3cK4LdFFB-JHg3zlqk9mdQelv4IPA_J_GbA&oe=67B696E6" },
      { id: 7, name: "جهاز اعطاء سوائل", details: "الكارتون 500 قطعة %", price: 90000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480111705_122143213898425327_505076457814959398_n.jpg?stp=dst-jpg_p180x540_tt6&_nc_cat=106&ccb=1-7&_nc_sid=833d8c&_nc_ohc=WLVLO5Hw3MsQ7kNvgGvw5nF&_nc_oc=AdjG8t54Sk4e4xHUMaxyLXYXoYpUSxWHd70rbPfVNoHRGzhQpzqUyJjL8PGhO1jcl_g&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AN_QDTpV_TNc-psOx3DGacn&oh=00_AYB5Z9E7KsNzc1rvMVehoPifylVFKvBID7NCh_erPlDZuw&oe=67B51FEF" },
      { id: 8, name: "كلكوز سلاين 500ml", details: "الكارتون 30 قطعة%", price: 43000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480485760_122143352468425327_6542131389681420761_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=103&ccb=1-7&_nc_sid=833d8c&_nc_ohc=dElsbNdD1p4Q7kNvgHGWee1&_nc_oc=Adij5yUpus5VdQdoROjymICtbzJzsHHx_VOG3RyA-O6wBXresk_aWRUONxxsGD_JJ-0&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AbOC3KYj7NqT5sVl563DZWy&oh=00_AYDYxOCz3nC6xJNRjh-tRaSe5QrWrniqBdcx1tJZHvgwqA&oe=67B65E54" },
      { id: 9, name: "Distilled water 5ml", details: "الكارتون 20 باكيت", price: 300000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/479691298_122143221050425327_6744277068489980243_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=833d8c&_nc_ohc=I5nMi3WD_RoQ7kNvgEPJ9Sd&_nc_oc=AdhkrT_wqth-z_DbRDQo4BWeCzQwQMroeeuSRBTerA_fsFQjvWIcZTmRPkbUC6lapig&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=A0wbLDTe3OhcVYexqF1JAlP&oh=00_AYDYMBUHqo-BYvY2Qvx361HsUkpSLbpB8zNT4xNSAvjQOA&oe=67B53DEC" },
      { id: 10, name: "كانيولا خضراء", details: "باكيت 100 قطعة", price: 19000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480103206_122143219496425327_983658103625672085_n.jpg?stp=dst-jpg_s600x600_tt6&_nc_cat=104&ccb=1-7&_nc_sid=833d8c&_nc_ohc=znxi13NGTnQQ7kNvgFb18H6&_nc_oc=AdhXS0LYssj4VAasfbkJP64kiaCA0CayOsme3S5QJz4XAWZW9TCvSjxFO1U88NCGlaQ&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AiWp_PIfxy0BxTEemOiTUPN&oh=00_AYB6PsKosbhqiF-yVl9Vue9IeTLpE--2CkGxztmONL0cEQ&oe=67B52CB7" },
      { id: 11, name: "حمل test", details: "الباكيت 40 قطعة", price: 7000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/479867229_122143214330425327_9141020820194633164_n.jpg?stp=dst-jpg_s720x720_tt6&_nc_cat=106&ccb=1-7&_nc_sid=833d8c&_nc_ohc=9XF_srKsq6YQ7kNvgH54_wN&_nc_oc=Adg56BiHrLdErjWeweECrDGy2VYbT8Jh4cvPg-kzYHJZ5az-_ALcv-K7ZLzVYu0D0jA&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AD6DUKQ3VLHWeFcw-_ymbMa&oh=00_AYAFIEkOhC6Z93W5uLnqvZ3iYOFhYoVtjxwU5ThMpuQKaw&oe=67B5109D" },
      { id: 12, name: "لاسق جروح فوجيكا", details: "الكارتون 40 باكيت", price: 2750, quantity: 0, image: "https://scontent.fnjf1-4.fna.fbcdn.net/v/t39.30808-6/479691334_122143214582425327_8203050183050514339_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=833d8c&_nc_ohc=Y2BpvwIjkBsQ7kNvgEFPebR&_nc_oc=AdhS1ptRdNKWg3W_pvQ58ymcQ72xVoL9IMTNj8Sk9jCEW8qpcqDAPZaX4tlnPw0ssp8&_nc_zt=23&_nc_ht=scontent.fnjf1-4.fna&_nc_gid=AR9ZC-hQmZ97wDJwPD7wtew&oh=00_AYAnmkZqDVa9MLMf_jgc08H1J4CiksENPupjbinQikPzZg&oe=67B51842" },
      { id: 13, name: "جهاز سكر انكل بلص", price: 16000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480179129_122143214810425327_2896260034375835471_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=106&ccb=1-7&_nc_sid=833d8c&_nc_ohc=meqlu9Bn7GsQ7kNvgHV6ezD&_nc_oc=Adh8uIkMf-0DE3mavwi1C1UCnkbrOT-2vCvNXEeDC5WUSgFo7SQnxxaIrQov0p4RbVI&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=A3nh6eXRR7AiUaHU67JaPnN&oh=00_AYDmLeZhPnIJ_mQ0xtcjj7ryrlUxP_fShfLyDit-TO62Qg&oe=67B54262" },
      { id: 14, name: "شرائح سكر انكل بلص", details: "الكارتون 100 قطعة ", price: 390000, quantity: 0, image: "https://scontent.fnjf1-4.fna.fbcdn.net/v/t39.30808-6/480028242_122143450028425327_7473307691865866592_n.jpg?stp=dst-jpg_s720x720_tt6&_nc_cat=102&ccb=1-7&_nc_sid=833d8c&_nc_ohc=SGl6Hj2phj0Q7kNvgH4fKxE&_nc_oc=AdhogAQFttD7EdhUyDxbRnw9n8JNe2Czk4hGNFqdiZDbnk_yS1GD6MIfjcLn5dAQGSA&_nc_zt=23&_nc_ht=scontent.fnjf1-4.fna&_nc_gid=AIftfeabZjNMYOBWht9TXLz&oh=00_AYBxfLgspKl1n2ABtQ6m9Q5Raj-PftoE8yxPAiB8rmZShw&oe=67B7B885" },
      { id: 15, name: "Lido plus بخاخ اسنان", details: "الكارتون 100 قطعة ", price:160000, quantity: 0, image: "https://scontent.fnjf1-4.fna.fbcdn.net/v/t39.30808-6/480195483_122143353458425327_734452982856973169_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=109&ccb=1-7&_nc_sid=833d8c&_nc_ohc=daOzuoNJGY4Q7kNvgGqSU8o&_nc_oc=AdhLW8HW2PL_BAVs9AtnM76UYIb-652k8f2lkaj1R1YvLBKoZCefbTFTfS1-vD5MWkg&_nc_zt=23&_nc_ht=scontent.fnjf1-4.fna&_nc_gid=AJ2b7Fz8tsJJNOtV61HdgRj&oh=00_AYDxJokztM4iQ_s27jsTmv9fPM4i0HFmGMu7OhdTc4CkGw&oe=67B67EE6" },
      { id: 16, name: "سرنجة 1cc", details: "الكارتون 20 باكيت", price: 260000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/479731821_122143214156425327_1751375924376876955_n.jpg?stp=dst-jpg_s600x600_tt6&_nc_cat=104&ccb=1-7&_nc_sid=833d8c&_nc_ohc=xiSvIJnJmFQQ7kNvgEqGQxD&_nc_oc=AdgNtLAUig0JsAJwFEyWC-TyKmQP2848Sczig5MpzYFBK_AjwyZjtHYuFIt_Btf8rZs&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AzBCrTK1K2jqNHhhGet8fKl&oh=00_AYAh6y_tVlDeWOu99ugo2UVi8OeON2U_2h9-41PlEgiNdQ&oe=67B93578" },
      { id: 17, name: "كانيولا وردية ", details: "الباكيت 100", price: 19000, quantity: 0, image: "https://5.imimg.com/data5/SELLER/Default/2022/12/JL/HD/PJ/4260638/nipro-cannula-2--500x500.jpg" },
      { id: 18, name: "كانيولا صفرة", details: " الباكيت 100", price: 19000, quantity: 0, image: "https://scontent.fnjf1-4.fna.fbcdn.net/v/t39.30808-6/480232175_122143219208425327_5689988929289678187_n.jpg?stp=dst-jpg_s720x720_tt6&_nc_cat=108&ccb=1-7&_nc_sid=833d8c&_nc_ohc=hwvHiBycHp0Q7kNvgGdPUQt&_nc_oc=AdglPVSetL4cNvB7O6LJmHvSNk95UxsS2W0Cv0_f3FPXDBesVfK1yN7x7TomlayRCLA&_nc_zt=23&_nc_ht=scontent.fnjf1-4.fna&_nc_gid=A9tebeM9qwLWNXcoXKjz_Dn&oh=00_AYCAYinxP6JxZXR8_KVzkeyzs5KLGKYGUm-8UM5vIsasCA&oe=67B5258B" },
      { id: 19, name: "كانيولا زرقاء", details: "الكارتون 100 قطعة", price: 19000, quantity: 0, image: "https://scontent.fnjf1-4.fna.fbcdn.net/v/t39.30808-6/480221558_122143215518425327_2388982947456534958_n.jpg?_nc_cat=107&ccb=1-7&_nc_sid=833d8c&_nc_ohc=zl5EiUBseGcQ7kNvgH7dn-W&_nc_oc=AdgN7EAaYXQMnhopA3t7FXHF3WFs0KQZI2y8zDzsUN1ei49GFfwLE7bu8BFmYAJAQbQ&_nc_zt=23&_nc_ht=scontent.fnjf1-4.fna&_nc_gid=A5x7iv49txHAQhtNpsHMsO1&oh=00_AYBgV_yO_cVJ0yb0cC2hmXMWUeEXPEqBsrnRpMZHW9-25Q&oe=67B524C3" },
      { id: 20, name: "سرنجة 5cc", price: 90000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480092751_122143211612425327_2058560408313796475_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=105&ccb=1-7&_nc_sid=833d8c&_nc_ohc=uDRHpz24shYQ7kNvgE6hlZb&_nc_oc=AdgzEEXEZlheQSaYv2icADabvVyQkETGV_WnVCChgY5QWz0oPXvNSLMZUhg9PFBArCM&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=A5EzlJmezBb10p-KnHGHh2P&oh=00_AYDLyvF-dfTo2ht7aMbAEBTZ0t7E6sNRguFnuvDW1UWH0Q&oe=67B91CA0" },
      { id: 21, name: "مزلق مساج ومحفز بلفواكه " , details: "الدرزن 12 قطعة ", price: 40000, quantity: 0, image: "https://scontent.fnjf1-4.fna.fbcdn.net/v/t39.30808-6/480204503_122143629434425327_426929920890741592_n.jpg?stp=dst-jpg_s600x600_tt6&_nc_cat=110&ccb=1-7&_nc_sid=833d8c&_nc_ohc=xWiyT97sisYQ7kNvgFaqn9e&_nc_oc=AdgNK7DGVB7hyHEnXtRhsFl54BKClEeXVqiqj8tnfBDlYw85uPoyRNCbfXXO-H8IkG8&_nc_zt=23&_nc_ht=scontent.fnjf1-4.fna&_nc_gid=Ao2tBYQ6BbvoxXhk8MU2fJl&oh=00_AYD2mpmItO3NoVpqbG271vfhEKAm088hG6zsD3nJwyx9wQ&oe=67B96EF3" },
      { id: 22, name: "فلاش كاركاس فواكه", details:"جميع الانواع ", price: 9900, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480321632_122143731884425327_6204086995165424814_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=105&ccb=1-7&_nc_sid=833d8c&_nc_ohc=kiTYT9y8FEIQ7kNvgFHx1Tr&_nc_oc=AdiGKhiKtOPpy-S9EapiV6Qde87zxBP6aSFD8XeFA43teO4loTN4kvqJ9B-c-ykITRE&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AinPDinBzHi0d_pCY7kZ4cX&oh=00_AYD2vT2FcNsyhgHZFFs8OCNpFKCE1LGNq9N6CcBmrYFHSQ&oe=67BA1058" },
      { id: 23, name: "سرنجة 3 cc ", details: "الكارتون 30 قطعة ", price: 130000, quantity: 0, image: "https://scontent.fnjf1-4.fna.fbcdn.net/v/t39.30808-6/480524563_122143731308425327_1939342426320123983_n.jpg?stp=dst-jpg_p526x296_tt6&_nc_cat=111&ccb=1-7&_nc_sid=833d8c&_nc_ohc=Whj624MmRJcQ7kNvgF1gw9u&_nc_oc=Adh0CytFQM_jlYYdavC92mX2g812dUcL1PknaHuVppaecwVfsL0rzBBeVbi9fK4uYfc&_nc_zt=23&_nc_ht=scontent.fnjf1-4.fna&_nc_gid=AEVfIaRGwQtMMAhhH7DkynR&oh=00_AYBoZg1LPCDSwBX8Om8TxJsU2kT5p-rdUwAWNhESaxfhJw&oe=67BA04A2" },
      { id: 24, name: "كريم تكبير ارداف وصدر ", details: "الدرزن 12 قطعة ", price: 48000, quantity: 0, image: "https://scontent.fnjf1-2.fna.fbcdn.net/v/t39.30808-6/480290150_122143629344425327_6555396395215924089_n.jpg?stp=dst-jpg_s1080x2048_tt6&_nc_cat=101&ccb=1-7&_nc_sid=833d8c&_nc_ohc=1RRTS03-fk8Q7kNvgH8w7D5&_nc_oc=Adh5HKvXQLAKMZamxJBqN03ptNb67v4a0rFQC1hB3Ja7eSYAKwnvkQ5xmWZtqLnrmw8&_nc_zt=23&_nc_ht=scontent.fnjf1-2.fna&_nc_gid=AI5rUuL91eweGRbs7HILe2A&oh=00_AYBJVlu1HGyG12CBQL_nhj0QmneFf5xhqUhL89QrJ5GrpQ&oe=67B965BF" },
     




    ];
  
    let cart = []; // عناصر سلة الشراء
    let savedProducts = JSON.parse(localStorage.getItem("savedProducts")) || [];
  
    // (مثال لتحديد المنتجات الأكثر مبيعاً إذا رغبت)
    const mostSoldProductIds = [2, 5, 7, 10];
  
    /* دوال عرض المنتجات */
    function renderProducts(productArray = products) {
      const grid = document.getElementById("product-grid");
      grid.innerHTML = "";
      productArray.forEach((product, index) => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.setAttribute("data-product-id", product.id);
        // إذا كانت البطاقة من أول خمس، نضيف شارة ونسميها best-seller
        let badge = "";
        if (index < 5) {
          badge = `<div class="best-seller-badge">الأكثر مبيعاً</div>`;
          card.classList.add("best-seller");
        }
        card.innerHTML = `
          ${badge}
          <img src="${product.image}" alt="${product.name}" ondblclick="showImageModal('${product.image}')">
          <!-- زر حفظ المنتج -->
          <button class="save-btn ${isSaved(product.id) ? 'active' : ''}" onclick="toggleSave(${product.id}, this)">
            <svg viewBox="0 0 24 24">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5
                2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3
                16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
          </button>
          <div class="card-body">
            <div class="product-title">${product.name}</div>
            ${ product.details ? `<div class="product-details">${product.details}</div>` : "" }
            <div class="product-price">${product.price} IQD</div>
            <div class="quantity-controls">
              <button onclick="updateQuantity(${product.id}, -1, this)">-</button>
              <span id="qty-${product.id}">0</span>
              <button onclick="updateQuantity(${product.id}, 1, this)">+</button>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }
  
    /* التحقق من حفظ المنتج */
    function isSaved(productId) {
      return savedProducts.includes(productId);
    }
  
    /* تبديل حفظ المنتج */
    function toggleSave(productId, btn) {
      if (isSaved(productId)) {
        savedProducts = savedProducts.filter(id => id !== productId);
        btn.classList.remove("active");
      } else {
        savedProducts.push(productId);
        btn.classList.add("active");
        btn.classList.add("animate-heart");
        setTimeout(() => btn.classList.remove("animate-heart"), 500);
      }
      localStorage.setItem("savedProducts", JSON.stringify(savedProducts));
    }
  
    /* تحديث الكمية */
    function updateQuantity(productId, change, btn) {
      const qtyEl = document.getElementById("qty-" + productId);
      let currentQty = parseInt(qtyEl.textContent);
      currentQty = Math.max(0, currentQty + change);
      qtyEl.textContent = currentQty;
  
      btn.classList.add("shake");
      setTimeout(() => btn.classList.remove("shake"), 300);
  
      animateIndicator(btn, change > 0 ? 'plus' : 'minus');
  
      const existing = cart.find(item => item.id === productId);
      if (existing) {
        if (currentQty === 0) {
          cart = cart.filter(item => item.id !== productId);
        } else {
          existing.quantity = currentQty;
        }
      } else {
        if (currentQty > 0) {
          cart.push({ id: productId, quantity: currentQty });
        }
      }
    }
  
    /* إنشاء مؤشر الحركة */
    function animateIndicator(btn, type) {
      const indicator = document.createElement("span");
      indicator.className = "indicator " + (type === 'plus' ? "plus-indicator" : "minus-indicator");
      indicator.textContent = type === 'plus' ? "+" : "-";
      const container = btn.parentElement;
      const btnLeft = btn.offsetLeft;
      const btnTop = btn.offsetTop;
      const btnCenterX = btnLeft + btn.offsetWidth/2 - 10;
      indicator.style.left = btnCenterX + "px";
      indicator.style.top = btnTop + "px";
      container.appendChild(indicator);
      setTimeout(() => indicator.remove(), 500);
    }
  
    /* تصفية المنتجات بناءً على البحث */
    function filterProducts(query) {
      const filtered = products.filter(p => p.name.toLowerCase().includes(query.toLowerCase()));
      renderProducts(filtered);
    }
  
    /* نوافذ منبثقة */
    function openCartModal() {
      const modalOverlay = document.getElementById("cart-modal");
      const dynamicContent = document.getElementById("modal-dynamic-content");
      dynamicContent.innerHTML = renderCartSummary();
      modalOverlay.classList.add("active");
    }
  
    function renderCartSummary() {
      if (cart.length === 0) {
        return `<div class="modal-header"><h4>سلة الشراء فارغة</h4></div>`;
      }
      let html = `<div class="modal-header"><h4>ملخص سلة الشراء</h4></div><div class="modal-body">`;
      let total = 0;
      cart.forEach(item => {
        const product = products.find(p => p.id === item.id);
        const productTotal = product.price * item.quantity;
        total += productTotal;
        html += `<div class="cart-item" onclick="scrollToProduct(${product.id})">
          <div>${product.name} (×${item.quantity})</div>
          <div>${productTotal} IQD</div>
        </div>`;
      });
      html += `</div>
        <div class="cart-total">المجموع الكلي: ${total} IQD</div>
        <button class="btn btn-primary btn-purchase" onclick="showPharmacyForm()">شراء</button>`;
      return html;
    }
  
    function showPharmacyForm() {
      const dynamicContent = document.getElementById("modal-dynamic-content");
      dynamicContent.innerHTML = `
        <div class="modal-header"><h4>معلومات الصيدلية</h4></div>
        <div class="modal-body">
          <form id="pharmacy-form" class="pharmacy-form">
            <input type="text" id="pharmacy-name" class="form-control" placeholder="اسم الصيدلية" required>
            <input type="text" id="pharmacy-address" class="form-control" placeholder="العنوان" required>
            <input type="text" id="pharmacy-phone" class="form-control" placeholder="رقم الهاتف" required>
            <textarea id="pharmacy-notes" class="form-control" placeholder="ملاحظات"></textarea>
            <button type="submit" class="btn btn-success btn-purchase mt-2">أرسل الطلب عبر الواتساب</button>
          </form>
        </div>
      `;
      document.getElementById("pharmacy-form").addEventListener("submit", function(e) {
        e.preventDefault();
        sendOrder();
      });
    }
  
    function sendOrder() {
      const pharmacyName = document.getElementById("pharmacy-name").value.trim();
      const pharmacyAddress = document.getElementById("pharmacy-address").value.trim();
      const pharmacyPhone = document.getElementById("pharmacy-phone").value.trim();
      const pharmacyNotes = document.getElementById("pharmacy-notes").value.trim();
      if (!pharmacyName || !pharmacyAddress || !pharmacyPhone) {
        alert("يرجى ملء جميع الحقول المطلوبة.");
        return;
      }
  
      // بناء الرسالة بالشكل المطلوب
      let message = "� *تفاصيل المنتجات*:%0A";
      cart.forEach((item, index) => {
        const product = products.find(p => p.id === item.id);
        const productTotal = product.price * item.quantity;
        message += "--------------------------------%0A";
        message += `� *المنتج ${index + 1}:* ${product.name}%0A`;
        message += `� *السعر:* ${product.price} IQD%0A`;
        message += `� *الكمية:* ${item.quantity}%0A`;
        message += `� *الإجمالي:* ${productTotal} IQD%0A`;
      });
      message += "--------------------------------%0A";
  
      const total = cart.reduce((sum, item) => {
        const product = products.find(p => p.id === item.id);
        return sum + (product.price * item.quantity);
      }, 0);
  
      message += `%0A� *المجموع الكلي*: ${total} IQD%0A%0A`;
      message += "� *معلومات الصيدلية*:%0A";
      message += `• *الاسم*: ${pharmacyName}%0A`;
      message += `• *رقم الهاتف*: ${pharmacyPhone}%0A`;
      message += `• *العنوان*: ${pharmacyAddress}%0A`;
      if(pharmacyNotes) {
        message += `• *الملاحظات*: ${pharmacyNotes}%0A`;
      }
  
      const whatsappNumber = "9647824130002";
      const url = `https://wa.me/${whatsappNumber}?text=${message}`;
      window.open(url, "_blank");
    }
  
    /* دوال المحفوظات */
    function openFavoritesModal() {
      const favModal = document.getElementById("favorites-modal");
      document.getElementById("favorites-content").innerHTML = renderFavorites();
      favModal.classList.add("active");
    }
  
    function renderFavorites() {
      const favProducts = products.filter(p => savedProducts.includes(p.id));
      if (favProducts.length === 0) {
        return `<div class="modal-header"><h4>لا توجد منتجات محفوظة</h4></div>`;
      }
      let html = `<div class="modal-header"><h4>المحفوظات</h4></div><div class="modal-body">`;
      favProducts.forEach(product => {
        html += `<div class="cart-item" onclick="scrollToProduct(${product.id})">
          <div>${product.name}</div>
          <div>${product.price} IQD</div>
        </div>`;
      });
      html += `</div>`;
      return html;
    }
  
    /* دوال الأكثر مبيعاً */
    function openMostSoldModal() {
      const modal = document.getElementById("most-sold-modal");
      document.getElementById("most-sold-content").innerHTML = renderMostSold();
      modal.classList.add("active");
    }
  
    function renderMostSold() {
      // يمكنك تعديل التصفية حسب احتياجك؛ هنا نستخدم المصفوفة mostSoldProductIds
      const mostSold = products.filter(p => mostSoldProductIds.includes(p.id));
      if (mostSold.length === 0) {
        return `<div class="modal-header"><h4>لا توجد منتجات</h4></div>`;
      }
      let html = `<div class="modal-header"><h4>الأكثر مبيعا</h4></div><div class="modal-body">`;
      mostSold.forEach(product => {
        html += `<div class="cart-item" onclick="scrollToProduct(${product.id})">
          <div>${product.name}</div>
          <div>${product.price} IQD</div>
        </div>`;
      });
      html += `</div>`;
      return html;
    }
  
    /* التوجيه لبطاقة المنتج مع إخفاء النوافذ المنبثقة */
    function scrollToProduct(productId) {
      const card = document.querySelector(`.product-card[data-product-id="${productId}"]`);
      if (card) {
        card.classList.add("highlight");
        card.scrollIntoView({ behavior: 'smooth', block: 'center' });
        setTimeout(() => card.classList.remove("highlight"), 1500);
      }
      // إخفاء نوافذ المحفوظات والأكثر مبيعاً
      document.getElementById("favorites-modal").classList.remove("active");
      document.getElementById("most-sold-modal").classList.remove("active");
    }
  
    /* أحداث النقر على عناصر الشريط الجانبي */
    document.getElementById("toggle-sidebar").addEventListener("click", function(e) {
      document.getElementById("sidebar").classList.toggle("expanded");
      e.stopPropagation();
    });
  
    document.getElementById("menu-home").addEventListener("click", function() {
      this.querySelector("svg").classList.add("animate-home");
      setTimeout(() => this.querySelector("svg").classList.remove("animate-home"), 500);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  
    // زر البحث: تمديد شريط البحث وتغيير رمز الزر عند النقر
    document.getElementById("menu-search").addEventListener("click", function() {
      this.querySelector("svg").classList.add("animate-search");
      setTimeout(() => this.querySelector("svg").classList.remove("animate-search"), 500);
      const searchContainer = document.getElementById("search-bar-container");
      searchContainer.classList.toggle("active");
      if(searchContainer.classList.contains("active")){
        // تغيير رمز البحث إلى رمز الإغلاق (×)
        this.querySelector("svg").innerHTML = '<line x1="18" y1="6" x2="6" y2="18" stroke="var(--primary-color)" stroke-width="2" stroke-linecap="round"/><line x1="6" y1="6" x2="18" y2="18" stroke="var(--primary-color)" stroke-width="2" stroke-linecap="round"/>';
        document.getElementById("search-bar").focus();
      } else {
        // إعادة رمز البحث الأصلي
        this.querySelector("svg").innerHTML = '<path d="M21 21l-4.35-4.35M10 18a8 8 0 100-16 8 8 0 000 16z" stroke="var(--primary-color)" stroke-width="2" stroke-linecap="round" fill="none"/>';
      }
    });
  
    // زر الأكثر مبيعاً
    document.getElementById("menu-most-sold").addEventListener("click", function() {
      this.querySelector("svg").classList.add("animate-heart");
      setTimeout(() => this.querySelector("svg").classList.remove("animate-heart"), 500);
      openMostSoldModal();
    });
  
    document.getElementById("menu-favorites").addEventListener("click", function() {
      this.querySelector("svg").classList.add("animate-heart");
      setTimeout(() => this.querySelector("svg").classList.remove("animate-heart"), 500);
      openFavoritesModal();
    });
  
    document.getElementById("menu-darkmode").addEventListener("click", function() {
      const icon = document.getElementById("darkmode-icon");
      icon.classList.add("toggle-animation");
      setTimeout(() => {
        document.body.classList.toggle("dark-mode");
        if (document.body.classList.contains("dark-mode")) {
          icon.innerHTML = `<circle cx="12" cy="12" r="5" fill="var(--primary-color)"/>
            <g stroke="var(--primary-color)" stroke-width="2">
              <line x1="12" y1="1" x2="12" y2="4"/>
              <line x1="12" y1="20" x2="12" y2="23"/>
              <line x1="4.22" y1="4.22" x2="6.34" y2="6.34"/>
              <line x1="17.66" y1="17.66" x2="19.78" y2="19.78"/>
              <line x1="1" y1="12" x2="4" y2="12"/>
              <line x1="20" y1="12" x2="23" y2="12"/>
              <line x1="4.22" y1="19.78" x2="6.34" y2="17.66"/>
              <line x1="17.66" y1="6.34" x2="19.78" y2="4.22"/>
            </g>`;
        } else {
          icon.innerHTML = `<path d="M21 12.79A9 9 0 0111.21 3 7 7 0 1012 21a9 9 0 009-8.21z" fill="var(--primary-color)"/>`;
        }
        icon.classList.remove("toggle-animation");
      }, 500);
    });
  
    document.getElementById("fab-cart").addEventListener("click", openCartModal);
    document.getElementById("modal-close").addEventListener("click", function() {
      document.getElementById("cart-modal").classList.remove("active");
    });
    document.getElementById("favorites-modal-close").addEventListener("click", function() {
      document.getElementById("favorites-modal").classList.remove("active");
    });
    document.getElementById("most-sold-modal-close").addEventListener("click", function() {
      document.getElementById("most-sold-modal").classList.remove("active");
    });
  
    /* عرض نافذة تكبير الصورة */
    function showImageModal(src) {
      const modal = document.getElementById("image-modal");
      document.getElementById("modal-image").src = src;
      modal.classList.add("active");
    }
    document.getElementById("image-modal-close").addEventListener("click", function() {
      document.getElementById("image-modal").classList.remove("active");
    });
  
    // تفعيل التصفية عند الكتابة في شريط البحث
    document.getElementById("search-bar").addEventListener("keyup", function() {
      filterProducts(this.value);
    });
  
    /* تهيئة عرض المنتجات */
    renderProducts();
  
    // عند تحميل الصفحة، حساب وعرض عدد الأعضاء (عدد الرموز + 5000)
    document.addEventListener("DOMContentLoaded", function() {
      const memberCountEl = document.getElementById("member-count");
      if(memberCountEl) {
        const count = validCodes.length + 5000;
        memberCountEl.textContent = count;
      }
    });
  </script>
  
</body>
</html>
